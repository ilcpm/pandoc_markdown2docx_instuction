# 需要实现的功能

* 自定义多**节**的页眉页脚
  * 位于单独的xml文件中，不能通过在正文中插入xml实现
  * 可能可以通过引用reference.docx实现对多节页眉页脚的直接插入
  * 原生实现方式：
    * 多节的页眉页脚分成多个header.xml和footer.xml文件记录
    * 在.rels文件中规定“关系”，指定对应xml文件`r:id`属性的值，如果没有该属性，则无法将对应的页眉页脚文件对应到该节，报错
    * pandoc在引用refer.docx的时候复制了所有的xml文件，但是没有复制.rels文件，所以无法提早知道生成的新docx里面的xml的`r:id`值
    * **无法通过指定ooxml实现**
* 取消指定标题的编号
  * （暂不知道具体操作步骤）
* 表格的便捷插入
  * 暂不知道如何实现
  * 一种思路是每个表格放入单独docx文件，通过复制正文xml实现
* yaml配置文件
  * 最后写插件时来考虑

## 确认思路

* 指定区间书签标记
  * 对指定区间前后插入书签标记内容
  * 对段落级别（如题注的部分）的部分应用书签可在段落层次插入书签代码
* 指定位置域代码插入
* 在指定位置插入域代码以实现图片公式表格的题注的原生实现（即编号）
  * 通过指定yaml实现如`图 1-3`，`图 22`的实现（不需要手动计算编号，Word自动计算）
  * 为了实现原生的交叉引用，需要进行书签标注

上面三个原理相同，**对json文本的拆解然后插入新的ooxml代码**

* 插入封面（单独的文件）
  * 复制指定文件的正文xml部分导入
* 摘要附录（需要支持多个一级标题）
* 摘要位于封面后方目录前方
* 附录位于参考文献后方

## 完成技术验证

* 目录
* 标题编号（Word模版中对标题样式绑定编号）
* 插入分节符（并非特殊字符）
  * 一段ooxml
* 指定位置特殊字符插入
  * 分页符
  * **制表符**（文本类型代码片段，需编程实现json拆分才可验证）
  * **特殊的页面居中&右对齐制表符**（文本类型代码片段，需编程实现json拆分才可验证）
* 套用模版中的自定义样式
  * pandoc手册P119
  * 若样式不存在，则自动创建
